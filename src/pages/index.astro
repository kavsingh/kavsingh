---
import { getCollection } from "astro:content";

import ContactLinks from "../components/contact-links.astro";
import Experience from "../components/experience.astro";
import Education from "../components/education.astro";
import Content from "../components/content.astro";
import ListSection from "../components/list-section.astro";
import { sortIds } from "../utils/sort";

const experienceCollection = (await getCollection("experience")).sort(sortIds);
const educationCollection = (await getCollection("education")).sort(sortIds);
const csp = import.meta.env.DEV
	? "default-src * 'unsafe-inline';"
	: "default-src 'none'; style-src 'self' 'unsafe-inline'; img-src 'self';";
---

<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>CV - Kanwaljeet Singh</title>
		<meta
			name="description"
			content="Developer building for web and mobile in Berlin"
		/>
		<meta http-equiv="Content-Security-Policy" content={csp} />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=5, minimal-ui"
		/>
		<link rel="icon" type="image/png" href="/favicon.png" />
	</head>
	<body>
		<main
			class="max-w-[56rem] mx-auto grid grid-cols-[1fr] gap-16 p-8 print:max-w-none print:p-4 sm:py-16 sm:gap-y-32 sm:grid-cols-[fit-content(30%)_1fr]"
		>
			<header class="sm:contents sm:mb-32">
				<h1 class="my-2 p-0 font-semibold text-2xl text-black dark:text-white">
					Kanwaljeet Singh
				</h1>
				<div>
					<h2
						class="my-2 p-0 font-normal text-lg text-neutral-500 dark:text-neutral-400"
					>
						Web Developer
					</h2>
					<ContactLinks />
				</div>
			</header>
			<section class="sm:contents" aria-labelledby="about-title">
				<h2 class="text-5xl" id="about-title">
					<span role="img" aria-hidden>ðŸ‘‹</span>
					<div class="sr-only">About</div>
				</h2>
				<Content>
					<p>
						Developer building for web and mobile in Berlin. I'm enthusiastic
						about learning new web technologies and using them to build rich
						user experiences.
					</p>
				</Content>
			</section>
			<ListSection aria-labelledby="work-title">
				<span id="work-title" slot="title">Work</span>
				<ul slot="items">
					{
						experienceCollection.map((entry) => (
							<li class="mb-8 sm:mb-16">
								<Experience entry={entry} />
							</li>
						))
					}
				</ul>
			</ListSection>
			<ListSection aria-labelledby="study-title">
				<span id="study-title" slot="title">Study</span>
				<ul slot="items">
					{
						educationCollection.map((entry) => (
							<li class="mb-8 sm:mb-16">
								<Education entry={entry} />
							</li>
						))
					}
				</ul>
			</ListSection>
		</main>
	</body>
</html>

<style is:global>
	@import "../styles/global.css";
</style>
